---
description: å¼€å‘æœåŠ¡å™¨ç«¯å£å†²çªé—®é¢˜çš„è¯Šæ–­å’Œè§£å†³æ–¹æ¡ˆ
---

# å¼€å‘æœåŠ¡å™¨ç«¯å£å†²çªè§£å†³æ–¹æ¡ˆ

## å¸¸è§é—®é¢˜
å¼€å‘æœåŠ¡å™¨å¯åŠ¨æ—¶é‡åˆ°"Port 1420 is already in use"é”™è¯¯ï¼Œé€šå¸¸æ˜¯ç”±äºä¹‹å‰çš„å¼€å‘æœåŠ¡å™¨è¿›ç¨‹æ²¡æœ‰æ­£ç¡®å…³é—­å¯¼è‡´çš„ã€‚

## è¯Šæ–­æ­¥éª¤

### 1. æ£€æŸ¥ç«¯å£å ç”¨æƒ…å†µ
```powershell
# Windowsç³»ç»Ÿ
netstat -ano | findstr :1420

# è¾“å‡ºç¤ºä¾‹
TCP    [::1]:1420             [::]:0                 LISTENING       15276
```

### 2. è¯†åˆ«å ç”¨è¿›ç¨‹
```powershell
# æ ¹æ®PIDæŸ¥çœ‹è¿›ç¨‹è¯¦æƒ…
tasklist /FI "PID eq 15276"

# è¾“å‡ºç¤ºä¾‹
æ˜ åƒåç§°                       PID ä¼šè¯å              ä¼šè¯#       å†…å­˜ä½¿ç”¨ 
========================= ======== ================ =========== ============
node.exe                     15276 Console                    1    172,024 K
```

### 3. ç»ˆæ­¢å ç”¨è¿›ç¨‹
```powershell
# å¼ºåˆ¶ç»ˆæ­¢è¿›ç¨‹
taskkill /F /PID 15276

# æˆåŠŸè¾“å‡º
æˆåŠŸ: å·²ç»ˆæ­¢ PID ä¸º 15276 çš„è¿›ç¨‹ã€‚
```

### 4. éªŒè¯ç«¯å£é‡Šæ”¾
```powershell
# å†æ¬¡æ£€æŸ¥ç«¯å£çŠ¶æ€
netstat -ano | findstr :1420

# åº”è¯¥åªæ˜¾ç¤ºTIME_WAITçŠ¶æ€çš„è¿æ¥ï¼Œæˆ–æ— è¾“å‡º
TCP    [::1]:49368            [::1]:1420             TIME_WAIT       0
```

## è‡ªåŠ¨åŒ–è§£å†³è„šæœ¬

### Windows PowerShellè„šæœ¬
```powershell
# kill-port-1420.ps1
$port = 1420
$processes = Get-NetTCPConnection -LocalPort $port -ErrorAction SilentlyContinue

if ($processes) {
    foreach ($process in $processes) {
        $pid = $process.OwningProcess
        Write-Host "Killing process $pid using port $port"
        Stop-Process -Id $pid -Force
    }
    Write-Host "Port $port has been freed"
} else {
    Write-Host "Port $port is not in use"
}
```

### è·¨å¹³å°Node.jsè„šæœ¬
```javascript
// scripts/kill-port.js
const { execSync } = require('child_process');

const port = process.argv[2] || 1420;

try {
  if (process.platform === 'win32') {
    // Windows
    const result = execSync(`netstat -ano | findstr :${port}`, { encoding: 'utf8' });
    const lines = result.split('\n').filter(line => line.includes('LISTENING'));
    
    lines.forEach(line => {
      const pid = line.trim().split(/\s+/).pop();
      if (pid && !isNaN(pid)) {
        execSync(`taskkill /F /PID ${pid}`);
        console.log(`Killed process ${pid} using port ${port}`);
      }
    });
  } else {
    // macOS/Linux
    execSync(`lsof -ti:${port} | xargs kill -9`, { stdio: 'inherit' });
  }
  
  console.log(`Port ${port} has been freed`);
} catch (error) {
  console.log(`Port ${port} is not in use or already freed`);
}
```

## é¢„é˜²æªæ–½

### 1. æ­£ç¡®å…³é—­å¼€å‘æœåŠ¡å™¨
- ä½¿ç”¨ `Ctrl+C` è€Œä¸æ˜¯ç›´æ¥å…³é—­ç»ˆç«¯çª—å£
- ç­‰å¾…æœåŠ¡å™¨å®Œå…¨å…³é—­åå†å¯åŠ¨æ–°çš„å®ä¾‹
- é¿å…å¼ºåˆ¶å…³é—­IDEæˆ–ç»ˆç«¯

### 2. å¼€å‘è„šæœ¬ä¼˜åŒ–
```json
// package.json
{
  "scripts": {
    "dev": "node scripts/kill-port.js 1420 && pnpm tauri dev",
    "dev:clean": "node scripts/kill-port.js 1420 && pnpm tauri dev",
    "kill-port": "node scripts/kill-port.js"
  }
}
```

### 3. IDEé…ç½®
- **VS Code**: é…ç½®ä»»åŠ¡è‡ªåŠ¨æ¸…ç†ç«¯å£
- **WebStorm**: ä½¿ç”¨Run Configurationçš„Before Launchä»»åŠ¡
- **Cursor**: åˆ©ç”¨ä»»åŠ¡æ¨¡æ¿è‡ªåŠ¨åŒ–æµç¨‹

## å¸¸è§ç«¯å£å’ŒæœåŠ¡

### Tauriå¼€å‘ç¯å¢ƒ
- **1420**: Viteå¼€å‘æœåŠ¡å™¨é»˜è®¤ç«¯å£
- **1421**: å¤‡ç”¨ç«¯å£ï¼ˆViteè‡ªåŠ¨é€’å¢ï¼‰
- **3000**: å¸¸è§çš„Reactå¼€å‘æœåŠ¡å™¨ç«¯å£

### å…¶ä»–å¸¸è§å†²çª
- **3000**: Create React App, Next.js
- **5173**: Viteé»˜è®¤ç«¯å£
- **8080**: å„ç§å¼€å‘æœåŠ¡å™¨
- **4000**: æŸäº›GraphQLæœåŠ¡å™¨

## æ•…éšœæ’é™¤

### 1. è¿›ç¨‹æ— æ³•ç»ˆæ­¢
```powershell
# ä½¿ç”¨æ›´å¼ºåˆ¶çš„æ–¹æ³•
wmic process where "PID=15276" delete

# æˆ–è€…é‡å¯ç›¸å…³æœåŠ¡
net stop "Windows Audio"
net start "Windows Audio"
```

### 2. ç«¯å£ä»ç„¶æ˜¾ç¤ºå ç”¨
- ç­‰å¾…å‡ ç§’é’Ÿè®©ç³»ç»Ÿæ¸…ç†TIME_WAITè¿æ¥
- æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–ç›¸å…³è¿›ç¨‹
- é‡å¯ç½‘ç»œé€‚é…å™¨æˆ–é‡å¯è®¡ç®—æœº

### 3. æƒé™é—®é¢˜
```powershell
# ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡ŒPowerShell
Start-Process powershell -Verb runAs
```

## ç›‘æ§å’Œæ—¥å¿—

### 1. ç«¯å£ç›‘æ§è„šæœ¬
```javascript
// scripts/monitor-ports.js
const net = require('net');

const checkPort = (port) => {
  return new Promise((resolve) => {
    const server = net.createServer();
    server.listen(port, () => {
      server.close();
      resolve(true); // ç«¯å£å¯ç”¨
    });
    server.on('error', () => {
      resolve(false); // ç«¯å£è¢«å ç”¨
    });
  });
};

const monitorPorts = async () => {
  const ports = [1420, 1421, 3000, 5173];
  
  for (const port of ports) {
    const available = await checkPort(port);
    console.log(`Port ${port}: ${available ? 'Available' : 'In use'}`);
  }
};

monitorPorts();
```

### 2. å¼€å‘ç¯å¢ƒå¥åº·æ£€æŸ¥
```bash
#!/bin/bash
# scripts/dev-health-check.sh

echo "ğŸ” Checking development environment..."

# æ£€æŸ¥Node.jsç‰ˆæœ¬
echo "Node.js version: $(node --version)"

# æ£€æŸ¥pnpmç‰ˆæœ¬
echo "pnpm version: $(pnpm --version)"

# æ£€æŸ¥å…³é”®ç«¯å£
echo "Checking ports..."
node scripts/monitor-ports.js

# æ£€æŸ¥Tauri CLI
echo "Tauri CLI: $(tauri --version 2>/dev/null || echo 'Not installed')"

echo "âœ… Health check complete"
```

## ç›¸å…³é…ç½®æ–‡ä»¶

### Viteé…ç½®
```typescript
// vite.config.ts
export default defineConfig({
  server: {
    port: 1420,
    strictPort: true, // å¦‚æœç«¯å£è¢«å ç”¨åˆ™å¤±è´¥ï¼Œè€Œä¸æ˜¯è‡ªåŠ¨é€‰æ‹©å…¶ä»–ç«¯å£
    host: true,
  },
});
```

### Taurié…ç½®
```json
// src-tauri/tauri.conf.json
{
  "build": {
    "beforeDevCommand": "pnpm dev-in-tauri",
    "devPath": "http://localhost:1420"
  }
}
```

## æœ€ä½³å®è·µ

### 1. å¼€å‘æµç¨‹
1. å¯åŠ¨å‰æ£€æŸ¥ç«¯å£çŠ¶æ€
2. ä½¿ç”¨è„šæœ¬è‡ªåŠ¨æ¸…ç†å†²çªç«¯å£
3. æ­£ç¡®å…³é—­å¼€å‘æœåŠ¡å™¨
4. å®šæœŸæ¸…ç†åƒµå°¸è¿›ç¨‹

### 2. å›¢é˜Ÿåä½œ
- ç»Ÿä¸€ä½¿ç”¨ç›¸åŒçš„ç«¯å£é…ç½®
- å…±äº«ç«¯å£æ¸…ç†è„šæœ¬
- æ–‡æ¡£åŒ–å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ
- å»ºç«‹å¼€å‘ç¯å¢ƒæ£€æŸ¥æ¸…å•

### 3. CI/CDé›†æˆ
- åœ¨æ„å»ºè„šæœ¬ä¸­åŒ…å«ç«¯å£æ£€æŸ¥
- è‡ªåŠ¨åŒ–æµ‹è¯•å‰æ¸…ç†ç«¯å£
- ç›‘æ§æ„å»ºç¯å¢ƒçš„ç«¯å£ä½¿ç”¨æƒ…å†µ

## ç›¸å…³æ–‡ä»¶
- [vite.config.ts](mdc:vite.config.ts) - Viteå¼€å‘æœåŠ¡å™¨é…ç½®
- [src-tauri/tauri.conf.json](mdc:src-tauri/tauri.conf.json) - Taurié…ç½®
- [package.json](mdc:package.json) - npmè„šæœ¬é…ç½®
- `scripts/` - è‡ªåŠ¨åŒ–è„šæœ¬ç›®å½•