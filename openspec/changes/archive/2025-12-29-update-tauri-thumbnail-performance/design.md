## 上下文
- 桌面端一次性渲染大量文件项会触发多次文件信息查询与缩略图生成，导致主线程压力过高。
- 当前缩略图以 base64 方式生成与缓存，数量一大时 CPU 与内存占用增长明显。

## 目标 / 非目标
- 目标：在桌面端打开包含大量图片（>150 张）时，降低首屏卡顿，保证滚动与交互流畅。
- 目标：引入可控的缩略图降质策略与用户开关。
- 非目标：本次不改动网页端性能策略与行为。

## 决策
- 决策：引入列表虚拟化，仅渲染可见行，降低渲染与缩略图触发数量。
- 决策：缩略图采用懒加载与并发限制，避免同时生成过多缩略图。
- 决策：当文件数量超过阈值（默认 150）时，缩略图生成使用较小尺寸与较低质量。
- 决策：提供“关闭缩略图”的用户选项，关闭时不生成缩略图并清理缓存。

## 考虑的替代方案
- 只做并发限制：可降低峰值但无法解决大量 DOM 渲染成本。
- 仅使用图片原始大小：实现简单，但无法满足大量图片场景的性能需求。

## 风险 / 权衡
- 虚拟化可能影响测量与拖拽交互，需要验证列表滚动与选择逻辑。
- 降低质量可能影响视觉清晰度，需要选择合适默认值并允许用户关闭缩略图。

## 迁移计划
- 逐步切换：先接入虚拟化与懒加载，再引入阈值降质与开关。
- 回滚方案：保留开关或配置以快速恢复为全量渲染/原质量。

## 待决问题
- 是否需要在设置中暴露阈值与质量参数，还是仅使用默认值。
